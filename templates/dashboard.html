<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Patient Health Dashboard</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Google Fonts -->
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <style>
      body {
        font-family: 'Inter', sans-serif;
        background-color: #f1f5f9;
      }

      /* Transition for sidebar */
      .sidebar {
        transition: all 0.3s ease;
      }
      /* Hide scrollbar but keep scroll functionality */
      .sidebar {
        overflow-y: scroll;
        -ms-overflow-style: none; /* IE and Edge */
        scrollbar-width: none; /* Firefox */
      }

      .sidebar::-webkit-scrollbar {
        display: none; /* Chrome, Safari, Opera */
      }
    </style>
  </head>
  <body class="antialiased text-slate-700">
    <!-- Sidebar Overlay -->
    <div
      id="sidebar-overlay"
      class="fixed inset-0 bg-black bg-opacity-40 hidden z-40 transition-opacity duration-300 xl:hidden"
    ></div>
    <!-- Sidebar Toggle Button -->
    <button
      id="menu-toggle"
      class="xl:hidden fixed top-4 left-4 z-40 bg-white p-2 rounded-lg shadow-md hover:bg-slate-100 focus:outline-none"
    >
      <!-- Hamburger Icon -->
      <svg
        xmlns="http://www.w3.org/2000/svg"
        class="h-6 w-6 text-slate-700"
        fill="none"
        viewBox="0 0 24 24"
        stroke="currentColor"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M4 6h16M4 12h16M4 18h16"
        />
      </svg>
    </button>

    <div class="flex h-full">
      <!-- Sidebar -->
      <aside
        id="sidebar"
  class="sidebar w-64 bg-white rounded-r-2xl shadow-lg h-screen fixed top-0 left-0 overflow-y-auto transform -translate-x-full xl:translate-x-0 z-50">
  <div class="p-6 border-b border-slate-200 flex justify-between items-center">
    <h1 class="text-2xl font-bold text-slate-800">Dashboard</h1>
    <button id="close-sidebar" class="xl:hidden">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-slate-600 hover:text-slate-800" fill="none"
        viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
          d="M6 18L18 6M6 6l12 12" />
      </svg>
    </button>
  </div>

      <!-- Navigation -->
      <nav class="p-6 space-y-6 text-slate-700">

        <!-- User Section -->
        <div>
          <h2
            class="text-sm font-semibold uppercase tracking-wide text-slate-500 mb-2 flex items-center gap-2">
            <span class="text-purple-500">üë§</span> User Section
          </h2>
          <ul class="ml-3 space-y-2">
            <li><a href="#" class="block px-3 py-2 rounded-lg hover:bg-slate-100 hover:text-blue-600">Login / Sign Up</a></li>
            <li><a href="#" class="block px-3 py-2 rounded-lg hover:bg-slate-100 hover:text-blue-600">Profile</a></li>
            <li><a href="#" class="block px-3 py-2 rounded-lg hover:bg-slate-100 hover:text-blue-600">Sign Out</a></li>
          </ul>
        </div>

        <!-- Dashboard Section -->
        <div>
          <h2
            class="text-sm font-semibold uppercase tracking-wide text-slate-500 mb-2 flex items-center gap-2">
            <span class="text-pink-500">üìä</span> Dashboard Section
          </h2>
          <ul class="ml-3 space-y-2">
            <li><a href="#" class="block px-3 py-2 rounded-lg hover:bg-slate-100 hover:text-blue-600">Home / Overview</a></li>
            <li><a href="#" class="block px-3 py-2 rounded-lg hover:bg-slate-100 hover:text-blue-600">My Health Data</a></li>
            <li><a href="#" class="block px-3 py-2 rounded-lg hover:bg-slate-100 hover:text-blue-600">AQI Dashboard</a></li>
            <li><a href="#" class="block px-3 py-2 rounded-lg hover:bg-slate-100 hover:text-blue-600">Disease Risk Map</a></li>
          </ul>
        </div>

        <!-- Analytics Section -->
        <div>
          <h2
            class="text-sm font-semibold uppercase tracking-wide text-slate-500 mb-2 flex items-center gap-2">
            <span class="text-indigo-500">üìà</span> Analytics Section
          </h2>
          <ul class="ml-3 space-y-2">
            <li><a href="#" class="block px-3 py-2 rounded-lg hover:bg-slate-100 hover:text-blue-600">Trends & Graphs</a></li>
            <li><a href="#" class="block px-3 py-2 rounded-lg hover:bg-slate-100 hover:text-blue-600">Predictive Alerts</a></li>
            <li><a href="#" class="block px-3 py-2 rounded-lg hover:bg-slate-100 hover:text-blue-600">Reports & Downloads</a></li>
          </ul>
        </div>

        <!-- Community / Info Section -->
        <div>
          <h2
            class="text-sm font-semibold uppercase tracking-wide text-slate-500 mb-2 flex items-center gap-2">
            <span class="text-green-500">üåç</span> Community / Info Section
          </h2>
          <ul class="ml-3 space-y-2">
            <li><a href="#" class="block px-3 py-2 rounded-lg hover:bg-slate-100 hover:text-blue-600">Prevention Tips</a></li>
            <li><a href="#" class="block px-3 py-2 rounded-lg hover:bg-slate-100 hover:text-blue-600">Awareness Zone</a></li>
            <li><a href="#" class="block px-3 py-2 rounded-lg hover:bg-slate-100 hover:text-blue-600">Discussion Forum / Support</a></li>
          </ul>
        </div>

        <!-- Settings Section -->
        <div>
          <h2
            class="text-sm font-semibold uppercase tracking-wide text-slate-500 mb-2 flex items-center gap-2">
            <span class="text-gray-500">‚öôÔ∏è</span> Settings Section
          </h2>
          <ul class="ml-3 space-y-2">
            <li><a href="#" class="block px-3 py-2 rounded-lg hover:bg-slate-100 hover:text-blue-600">App Settings</a></li>
            <li><a href="#" class="block px-3 py-2 rounded-lg hover:bg-slate-100 hover:text-blue-600">Notification Preferences</a></li>
            <li><a href="#" class="block px-3 py-2 rounded-lg hover:bg-slate-100 hover:text-blue-600">Help & Contact Us</a></li>
          </ul>
        </div>

      </nav>
    </aside>

    <!-- Main Content -->
    <div class="flex-1 xl:ml-64 p-6 ">
      <header class="mb-8">
        <h1 class="text-3xl font-bold text-slate-800" style="margin-top: 40px;">Epidemiological Geo-mapping</h1>
        <p class="text-slate-500 mt-1">Analysis of Air Quality Index and COPD Burden in Chittoor-District</p>
      </header>

      <!-- Map & Charts -->
      <div class="grid grid-cols-1 xl:grid-cols-3 gap-6">
        <!-- Map Card -->
        <section class="bg-white p-6 rounded-2xl shadow-lg xl:col-span-2">
          <h2 class="text-xl font-semibold mb-4 text-slate-800">Patient Locations</h2>
          <div class="w-full h-96 rounded-xl overflow-hidden relative">
            <iframe src="{{ url_for('map_page') }}" class="absolute top-0 left-0 w-full h-full border-none"></iframe>
          </div>
        </section>

        <!-- Revenue Division Card -->
        <section class="bg-white p-6 rounded-2xl shadow-lg">
          <h2 class="text-xl font-semibold mb-4 text-slate-800">Distribution by Revenue Division</h2>
          <div class="h-96 flex items-center justify-center">
            <canvas id="revenueDonutChart"></canvas>
          </div>
        </section>

        <!-- Age Group Card -->
        <section class="bg-white p-6 rounded-2xl shadow-lg xl:col-span-2">
          <h2 class="text-xl font-semibold mb-4 text-slate-800">Patients by Age Group</h2>
          <div class="h-80">
            <canvas id="ageChart"></canvas>
          </div>
        </section>

        <!-- AQI Range Card -->
        <section class="bg-white p-6 rounded-2xl shadow-lg">
          <h2 class="text-xl font-semibold mb-4 text-slate-800">Patients by AQI Range</h2>
          <div class="h-80">
            <canvas id="aqiLineChart"></canvas>
          </div>
        </section>
      </div>
    </div>
  </div>

  <!-- Sidebar Toggle Script -->
  <script>
        // Global Chart.js configuration for fonts
        Chart.defaults.font.family = "'Inter', sans-serif";
        Chart.defaults.font.weight = '500';

        // Age Group Bar Chart
        const ageGroups = {{ age_groups | tojson }};
        const chartLabels = Object.keys(ageGroups);
        const chartData = Object.values(ageGroups);
        const ageCtx = document.getElementById('ageChart').getContext('2d');
        new Chart(ageCtx, {
            type: 'bar',
            data: {
                labels: Object.keys(ageGroups),
                datasets: [{
                    label: 'Total Patients',
                    data: Object.values(ageGroups),
                    backgroundColor: [
                        '#4dd0e1','#4fc3f7','#64b5f6','#ef5350',
                        '#ffca28','#81c784','#ba68c8','#ff8a65'
                    ], // sky-600 with opacity
                    borderColor: 'rgb(2, 132, 199)',
                    borderWidth: 2,
                    borderRadius: 8,
                    borderSkipped: false,
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false },
                    tooltip: {
                        backgroundColor: '#0f172a', // slate-900
                        titleFont: { size: 14, weight: 'bold' },
                        bodyFont: { size: 12 },
                        padding: 10,
                        cornerRadius: 8,
                        displayColors: false,
                    }
                },
                scales: {
                    y: { 
                        beginAtZero: true, 
                        grid: { color: '#e2e8f0' /* slate-200 */ },
                        ticks: { color: '#64748b' /* slate-500 */ },
                        title: { display: true, text: 'Total Patients', color: '#334155' /* slate-700 */ } 
                    },
                    x: { 
                        grid: { display: false },
                        ticks: { color: '#64748b' /* slate-500 */ },
                        title: { display: true, text: 'Age Group', color: '#334155' /* slate-700 */ } 
                    }
                }
            }
        });

        // Revenue Division Donut Chart
        const revenueData = { "Chittoor": 38, "Palamner": 25, "Nagari": 18, "Kuppam": 19 };
        const revenueCtx = document.getElementById('revenueDonutChart').getContext('2d');
        new Chart(revenueCtx, {
            type: 'doughnut',
            data: {
                labels: Object.keys(revenueData),
                datasets: [{
                    data: Object.values(revenueData),
                    backgroundColor: ['#06b6d4', '#f43f5e', '#facc15', '#4ade80'],
                    borderColor: '#f1f5f9', // Chart background color for spacing
                    borderWidth: 4,
                    hoverOffset: 10
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                cutout: '70%',
                plugins: {
                    legend: { position: 'bottom', labels: { color: '#334155' } },
                    tooltip: {
                        backgroundColor: '#0f172a',
                        titleFont: { size: 14, weight: 'bold' },
                        bodyFont: { size: 12 },
                        padding: 10,
                        cornerRadius: 8,
                    }
                }
            }
        });

        // AQI Range Line Chart
        const aqiData = { "70-75": 0, "75-80": 4, "80-85": 19, "85-90": 10, "90-95": 14, "95-100": 7, "100-105": 9 };
        const aqiCtx = document.getElementById('aqiLineChart').getContext('2d');
        new Chart(aqiCtx, {
            type: 'line',
            data: {
                labels: Object.keys(aqiData),
                datasets: [{
                    label: 'Patient Count',
                    data: Object.values(aqiData),
                    fill: true,
                    backgroundColor: 'rgba(14, 165, 233, 0.1)', // sky-500 with opacity
                    borderColor: '#0ea5e9', // sky-500
                    tension: 0.4,
                    pointRadius: 5,
                    pointBackgroundColor: '#0ea5e9',
                    pointBorderColor: '#fff',
                    pointHoverRadius: 7,
                    pointHoverBorderWidth: 2,
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false },
                     tooltip: {
                        backgroundColor: '#0f172a',
                        titleFont: { size: 14, weight: 'bold' },
                        bodyFont: { size: 12 },
                        padding: 10,
                        cornerRadius: 8,
                        displayColors: false,
                    }
                },
                scales: {
                    y: { 
                        beginAtZero: true, 
                        grid: { color: '#e2e8f0' },
                        ticks: { color: '#64748b' },
                        title: { display: true, text: 'Patient Count', color: '#334155' } 
                    },
                    x: { 
                        grid: { display: false },
                        ticks: { color: '#64748b' },
                        title: { display: true, text: 'AQI Range', color: '#334155' } 
                    }
                }
            }
        });
  const sidebar = document.getElementById("sidebar");
  const menuToggle = document.getElementById("menu-toggle");
  const closeSidebar = document.getElementById("close-sidebar");
  const overlay = document.getElementById("sidebar-overlay");

  // Open Sidebar
  menuToggle.addEventListener("click", () => {
    sidebar.classList.remove("-translate-x-full");
    overlay.classList.remove("hidden");
  });

  // Close Sidebar
  closeSidebar.addEventListener("click", () => {
    sidebar.classList.add("-translate-x-full");
    overlay.classList.add("hidden");
  });

  // Click outside sidebar closes it
  overlay.addEventListener("click", () => {
    sidebar.classList.add("-translate-x-full");
    overlay.classList.add("hidden");
  });
</script>


</body>
</html>
